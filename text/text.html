<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>トップ - マイサイト</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Hiragino Kaku Gothic ProN","メイリオ",sans-serif;max-width:900px;margin:2rem auto;padding:0 1rem;}
    header{display:flex;justify-content:space-between;align-items:center}
    .card{border:1px solid #ddd;padding:1rem;margin:1rem 0;border-radius:6px}
    input[type="text"]{padding:.5rem;width:200px}
    button{padding:.5rem 1rem}
  </style>
</head>
<body>
  <header>
    <h1>ようこそ</h1>
    <div id="greeting"></div>
  </header>

  <section class="card">
    <h2>名前を教えてください（Cookie に保存されます）</h2>
    <form id="nameForm">
      <input type="text" id="nameInput" placeholder="あなたの名前">
      <button type="submit">保存</button>
      <button type="button" id="clearBtn">消去</button>
    </form>
    <p>保存するとページ右上に挨拶が出ます。Cookie は 365 日保持します。</p>
  </section>

  <section class="card">
    <h2>セクション</h2>
    <ul>
      <li><a href="./a/a.index.html">A セクション（/a/）</a></li>
      <li><a href="./b/b.index.html">B セクション（/b/）</a></li>
      <li><a href="./pages/a/info.md" target="_blank">pages/a/info.md（そのまま開く）</a></li>
    </ul>
  </section>

  <script>
    // 簡単な Cookie 操作
    function setCookie(name, value, days){
      const d = new Date();
      d.setTime(d.getTime() + (days*24*60*60*1000));
      document.cookie = name + "=" + encodeURIComponent(value) + ";path=/;expires=" + d.toUTCString();
    }
    function getCookie(name){
      const v = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)');
      return v ? decodeURIComponent(v.pop()) : '';
    }
    function eraseCookie(name){ setCookie(name,'',-1); }

    const form = document.getElementById('nameForm');
    const input = document.getElementById('nameInput');
    const greet = document.getElementById('greeting');
    const clearBtn = document.getElementById('clearBtn');

    function refreshGreeting(){
      const n = getCookie('visitorName');
      if(n) greet.textContent = n + ' さん';
      else greet.textContent = '';
    }
    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      const v = input.value.trim();
      if(!v) return alert('名前を入力してください');
      setCookie('visitorName', v, 365);
      refreshGreeting();
      alert('保存しました — 他のページでも挨拶が表示されます');
    });
    clearBtn.addEventListener('click', ()=>{
      eraseCookie('visitorName');
      refreshGreeting();
    });

    // 初期表示
    input.value = getCookie('visitorName') || '';
    refreshGreeting();
  </script>
</body>
</html>